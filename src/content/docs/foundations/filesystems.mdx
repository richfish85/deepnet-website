---
title: "Filesystems & Storage Paths (Deep Dive)"
slug: "filesystems"
category: "foundations"
tier: "free"
product: "cyberguard-core"
duration: "20 min"
level: "Intermediate"
---

File systems decide where persistence hides and what artifacts survive. This chapter keeps a defender’s lens on NTFS, ext4, and APFS.

## Core roles
- Map raw blocks into files, directories, and metadata.
- Enforce permissions (ACLs, POSIX bits, xattrs).
- Journal changes for crash recovery.
- Expose change history (USN, journals, snapshots).

## NTFS (Windows)
- MFT: every file has a record; mine it for timestamps and anomalies.
- Alternate Data Streams: hide config/payloads; alert on ADS in exec paths.
- Reparse points/junctions: detect unexpected redirections into System32/ProgramData.
- USN Journal: validates timelines; keep it enabled and collected.

## ext4 (Linux)
- Inodes + extents: filenames map to inode numbers; deletion doesn’t wipe data blocks immediately.
- Journaling modes change artifact survivability; ordered vs. writeback.
- xattrs: SELinux/AppArmor and user metadata; watch for tamper.
- Mount options: `noexec`, `nodev`, `nosuid` matter for hardening.

## APFS (macOS)
- Snapshots: rapid rollback and gold for forensics.
- CoW clones: same blocks, different names—track unexpected clones of tools.
- Volume roles: sealed system volume reduces write surface; focus on data volume for abuse.

## Detection cues
- Executables or scripts dropped into user-writeable + executable paths (temp, home, ProgramData).
- ADS on executables/scripts; unexpected junctions into privileged directories.
- RW→RX flips plus new binaries in PATH.
- New autoruns (registry, LaunchAgents, cron) tied to recent file writes.

## Hardening
- Enforce allowlists; block script execution from temp/user dirs.
- Monitor file creation with ADS or executable perms in non-admin paths.
- Keep journals/USN/snapshots enabled and ship them to telemetry.
- Audit SUID/SGID binaries, mount with `noexec`/`nodev`/`nosuid` where safe.
